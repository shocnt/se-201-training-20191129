{"status":{},"contains_secrets":true,"product_version":"3.0.0.1","spec":{"description":"","resources":{"client_attrs":{"None":{"y":294.5,"x":572.75},"mongodb_deployment":{"y":140.5,"x":433.75}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"mongo_db_service"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Pull DB Data"},{"kind":"app_task","name":"Load DB"}],"name":"48e38d66_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Pull DB Data"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Load DB"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"mongo_db_service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Pull DB Data","attrs":{"expected_response_params":[{"status":"SUCCESS","code":200,"type":""}],"request_body":"","headers":[],"url":"@@{data_url}@@\/testcoljp.json","response_paths":{"insert_script":"$.entities"},"retry_interval":1,"method":"GET","retry_count":1,"authentication":{"type":"none"},"tls_verify":false,"content_type":"application\/json","connection_timeout":120,"type":"","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"mongo_db_service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Load DB","attrs":{"exit_status":[],"script":"#!\/bin\/bash\n\nprintf 'db.peaks.insert(@@{insert_script}@@)' > \/tmp\/rawinsert.json\n\n#\/bin\/bash -c IFS='{' read -a INSERT < \/tmp\/rawinsert.json\n#\/bin\/bash -c for LINE in \"${INSERT[@]}\"; do printf \"{$LINE\\n\"; done | sed -e 's\/{db.\/db.\/' > \/tmp\/demodbinsert.json\n\n\/bin\/bash -c 'IFS=\"{\" read -a INSERT < \/tmp\/rawinsert.json; for LINE in \"${INSERT[@]}\"; do printf \"{$LINE\\n\"; done | sed -e \"s\/{db.\/db.\/\"' > \/tmp\/demodbinsert.json \n\ncat \/tmp\/demodbinsert.json\n\nmongo demodb < \/tmp\/demodbinsert.json\n\n\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"Nutanix"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"a8948e04_runbook","main_task_local_reference":{"kind":"app_task","name":"48e38d66_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"mongo_db_service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"62a74c74_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"d9296667_runbook","main_task_local_reference":{"kind":"app_task","name":"62a74c74_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"mongo_db_service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"735d51d7_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"fa1d4725_runbook","main_task_local_reference":{"kind":"app_task","name":"735d51d7_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"mongo_db_service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"431de246_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"a2a5a914_runbook","main_task_local_reference":{"kind":"app_task","name":"431de246_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"mongo_db_service"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"73ff05ab_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"3618b9a4_runbook","main_task_local_reference":{"kind":"app_task","name":"73ff05ab_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"mongo_db_service","port_list":[],"tier":"","container_spec":{"ports":[{"protocol":"TCP","containerPort":8080}],"name":"mongo-db-container"},"variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[],"type":"K8S_POD","name":"MongoDBPod","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"","delay_secs":"60","disable_readiness_probe":false},"os_type":"Linux","create_spec":{"metadata":{"labels":{"app":"mongodb_calm"},"namespace":"@@{yourname}@@","name":"MongoDBPod"},"type":"PROVISION_K8S_POD","spec":{"restartPolicy":"Always"},"account_uuid":"eee8b1fe-1425-4990-8715-470a56824d59"},"variable_list":[]}],"credential_definition_list":[{"username":"nutanix","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"QP+B\/0VIRO6qdNM2mGI2V2KR9Fp6wbWrmLq59BzzQDFajUbm4yGY0TXN:utf-8"},"name":"Nutanix"}],"package_definition_list":[{"image_spec":{"image":"mongo","imagePullPolicy":"Always"},"description":"","action_list":[],"type":"K8S_IMAGE","service_local_reference_list":[{"kind":"app_service","name":"mongo_db_service"}],"name":"Package3","version":"","variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"K8S_DEPLOYMENT","action_list":[],"name":"mongodb_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[{"kind":"app_published_service","name":"mongodb_calm_lb_service"}],"max_replicas":"100","package_local_reference_list":[{"kind":"app_package","name":"Package3"}],"substrate_local_reference":{"kind":"app_substrate","name":"MongoDBPod"},"options":{"type":"PROVISION_K8S_DEPLOYMENT","spec":{"replicas":"1","selector":{"matchLabels":{"app":"mongodb_calm"}}},"metadata":{"namespace":"@@{yourname}@@","name":"k8s-mongodb-deployment"}},"variable_list":[],"description":""}],"description":"","action_list":[],"name":"Default","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"data_url","value":"https:\/\/shuchida-cicd.s3-ap-northeast-1.amazonaws.com","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"yourname","value":"panlm","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]}],"published_service_definition_list":[{"singleton":true,"action_list":[],"type":"K8S_SERVICE","depends_on_list":[],"name":"mongodb_calm_lb_service","port_list":[],"tier":"","options":{"type":"PROVISION_K8S_SERVICE","spec":{"type":"ClusterIP","ports":[{"protocol":"TCP","targetPort":27017,"name":"","port":27017}],"selector":{"app":"mongodb_calm"}},"metadata":{"labels":{"app":"mongodb_calm"},"namespace":"@@{yourname}@@","name":"mongodb-calm-lb-service"}},"variable_list":[],"description":""}],"default_credential_local_reference":{"kind":"app_credential","name":"Nutanix"},"type":"USER"},"name":"cicd2-01_cicd-mongo"},"api_version":"3.0","metadata":{"last_update_time":"1593738510775419","kind":"blueprint","spec_version":1,"creation_time":"1593738355220588","name":"cicd2-01_cicd-mongo"}}